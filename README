scripts/config --disable SYSTEM_TRUSTED_KEYS
scripts/config --disable SYSTEM_REVOCATION_KEYS
scripts/config --set-str CONFIG_SYSTEM_TRUSTED_KEYS ""
scripts/config --set-str CONFIG_SYSTEM_REVOCATION_KEYS ""


# Copy the current running kernel config to the kernel source directory
cp /boot/config-$(uname -r) .config

# Update the .config file for the new kernel version
make olddefconfig

# Optional: Review and change kernel configuration if needed
make menuconfig

# Build the kernel image (using multiple cores to speed up the process)
make -j$(nproc)

# Build the kernel modules
make modules

# Install the kernel headers
sudo make headers_install

# Install the kernel modules
sudo make modules_install

# Install the kernel image
sudo make install

# Update the bootloader (if necessary)
sudo update-grub   # On Debian/Ubuntu-based systems

# Reboot into the new kernel
sudo reboot
